{"version":3,"sources":["loaders.js","scene.js","gui.js","FBOCompositor.js","hud.js","grid.js","main.js","run.js","events.js","util.js"],"names":[],"mappings":"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","file":"app.js","sourcesContent":["'use strict';\r\n\r\nvar LOADING_MANAGER = new THREE.LoadingManager();\r\nLOADING_MANAGER.onLoad = () => {\r\n\r\n\tmain();\r\n\trun();\r\n\r\n};\r\n\r\nLOADING_MANAGER.onProgress = ( item, loaded, total ) => {\r\n\r\n\tconsole.log( loaded + '/' + total, item );\r\n\r\n};\r\n\r\nvar SHADERS = {};\r\nvar SHADER_LOADER = new THREE.XHRLoader( LOADING_MANAGER );\r\nSHADER_LOADER.setResponseType( 'text' );\r\nSHADER_LOADER.showStatus = true;\r\n\r\nSHADER_LOADER.loadAll = ( SHADERS, urlObj ) => {\r\n\r\n\tObject.keys( urlObj ).forEach( ( key ) => {\r\n\r\n\t\tSHADER_LOADER.load( urlObj[ key ], ( shader ) => {\r\n\r\n\t\t\tSHADERS[ key ] = shader;\r\n\r\n\t\t} );\r\n\r\n\t} );\r\n\r\n};\r\n\r\nSHADER_LOADER.loadAll( SHADERS, {\r\n\r\n\tgridVert: './shaders/grid.vert',\r\n\tgridFrag: './shaders/grid.frag',\r\n\thudVert: './shaders/hud.vert',\r\n\thudFrag: './shaders/hud.frag',\r\n\tpassVert: './shaders/pass.vert',\r\n\tpassFrag: './shaders/pass.frag',\r\n\tnoiseFrag: './shaders/noise.frag',\r\n\r\n} );\r\n\r\nvar TEXTURES = {};\r\nvar TEXTURE_LOADER = new THREE.TextureLoader( LOADING_MANAGER );\r\nTEXTURE_LOADER.load( './textures/mc_red.jpg', ( tex ) => {\r\n\tTEXTURES.matcap = tex;\r\n} );\r\n","'use strict';\r\n\r\nif ( !Detector.webgl ){\r\n\tDetector.addGetWebGLMessage();\r\n}\r\n\r\nvar CANVAS, STATS;\r\nvar SCENE, CAMERA, CAMERA_CTRL, RENDERER;\r\nvar WIDTH = window.innerWidth;\r\nvar HEIGHT = window.innerHeight;\r\nvar PIXEL_RATIO = window.devicePixelRatio || 1;\r\nvar SCREEN_RATIO = WIDTH/HEIGHT;\r\nvar CLOCK = new THREE.Clock();\r\n\r\n// ---- Settings\r\n\tvar SCENE_SETTINGS = {\r\n\r\n\t\tbgColor: 0x24242d,\r\n\t\tenableGridHelper: false,\r\n\t\tenableAxisHelper: true\r\n\r\n\t};\r\n\r\n// ---- Scene\r\n\tCANVAS = document.getElementById( 'canvas-container' );\r\n\tSCENE = new THREE.Scene();\r\n\r\n// ---- Camera\r\n\tCAMERA = new THREE.PerspectiveCamera( 75, window.innerWidth/window.innerHeight, 10, 100000 );\r\n\t// CAMERA orbit control\r\n\tCAMERA_CTRL = new THREE.OrbitControls( CAMERA, CANVAS );\r\n\tCAMERA_CTRL.object.position.z = 600;\r\n\tCAMERA_CTRL.update();\r\n\r\n// ---- Renderer\r\n\tRENDERER = new THREE.WebGLRenderer( { antialias: true , alpha: true } );\r\n\tRENDERER.setSize( WIDTH, HEIGHT );\r\n\tRENDERER.setPixelRatio( PIXEL_RATIO );\r\n\tRENDERER.setClearColor( SCENE_SETTINGS.bgColor, 1 );\r\n\tRENDERER.autoClear = false;\r\n\tCANVAS.appendChild( RENDERER.domElement );\r\n\r\n// ---- Stats\r\n\tSTATS = new Stats();\r\n\tCANVAS.appendChild( STATS.domElement );\r\n\r\n// ---- grid & axis helper\r\n\tvar gridHelper = new THREE.GridHelper( 600, 50 );\r\n\tgridHelper.setColors( 0x00bbff, 0xffffff );\r\n\tgridHelper.material.opacity = 0.1;\r\n\tgridHelper.material.transparent = true;\r\n\tgridHelper.position.y = -300;\r\n\tSCENE.add( gridHelper );\r\n\r\n\tvar axisHelper = new THREE.AxisHelper( 50 );\r\n\tSCENE.add( axisHelper );\r\n\r\n\tfunction updateHelpers() {\r\n\t\tgridHelper.visible = !!SCENE_SETTINGS.enableGridHelper;\r\n\t\taxisHelper.visible = !!SCENE_SETTINGS.enableAxisHelper;\r\n\t}\r\n\tupdateHelpers();\r\n","'use strict';\r\n\r\nvar gui, gui_display, gui_settings;\r\n\r\nfunction initGui() {\r\n\r\n\t// gui_settings.add( Object, property, min, max, step ).name( 'name' );\r\n\r\n\tgui = new dat.GUI();\r\n\tgui.width = 300;\r\n\r\n\tgui_display = gui.addFolder( 'Display' );\r\n\t\tgui_display.autoListen = false;\r\n\r\n\tgui_settings = gui.addFolder( 'Settings' );\r\n\r\n\t\tgui_settings.addColor( SCENE_SETTINGS, 'bgColor' ).name( 'Background' );\r\n\t\tgui_settings.add( CAMERA, 'fov', 25, 120, 1 ).name( 'FOV' );\r\n\r\n\tgui_display.open();\r\n\tgui_settings.open();\r\n\r\n\tgui_settings.__controllers.forEach( ( controller ) => {\r\n\t\tcontroller.onChange( updateSettings );\r\n\t} );\r\n\r\n}\r\n\r\nfunction updateSettings() {\r\n\r\n\tCAMERA.updateProjectionMatrix();\r\n\tRENDERER.setClearColor( SCENE_SETTINGS.bgColor , 1.0 );\r\n\r\n}\r\n\r\nfunction updateGuiDisplay() {\r\n\r\n\tgui_display.__controllers.forEach( ( controller ) => {\r\n\t\tcontroller.updateDisplay();\r\n\t} );\r\n\r\n}\r\n","\r\nfunction FBOCompositor( renderer, bufferSize, passThruVertexShader ) {\r\n\r\n\tthis.renderer = renderer;\r\n\r\n\tthis._getWebGLExtensions();\r\n\tthis.bufferSize = bufferSize;\r\n\tthis.passThruVertexShader = passThruVertexShader;\r\n\tvar halfBufferSize = bufferSize * 0.5;\r\n\tthis.camera = new THREE.OrthographicCamera( -halfBufferSize, halfBufferSize, halfBufferSize, -halfBufferSize, 1, 10 );\r\n\tthis.camera.position.z = 5;\r\n\tthis.quad = new THREE.Mesh( new THREE.PlaneBufferGeometry( 2, 2 ), null );\r\n\tthis.scene = new THREE.Scene();\r\n\tthis.scene.add( this.quad );\r\n\tthis.dummyRenderTarget = new THREE.WebGLRenderTarget( 2, 2 );\r\n\r\n\tthis.passThruShader = new THREE.ShaderMaterial( {\r\n\r\n\t\tuniforms: {\r\n\t\t\tresolution: {\r\n\t\t\t\ttype: 'v2',\r\n\t\t\t\tvalue: new THREE.Vector2( this.bufferSize, this.bufferSize )\r\n\t\t\t},\r\n\t\t\tpassTexture: {\r\n\t\t\t\ttype: 't',\r\n\t\t\t\tvalue: null\r\n\t\t\t}\r\n\t\t},\r\n\t\tvertexShader: SHADERS.passVert,\r\n\t\tfragmentShader: SHADERS.passFrag\r\n\r\n\t} );\r\n\r\n\tthis.passes = [];\r\n\r\n}\r\n\r\nFBOCompositor.prototype = {\r\n\r\n\t_getWebGLExtensions: function () {\r\n\r\n\t\tvar gl = this.renderer.getContext();\r\n\t\tif ( !gl.getExtension( \"OES_texture_float\" ) ) {\r\n\t\t\tconsole.error( \"No support for float textures!\" );\r\n\t\t}\r\n\r\n\t\tif ( gl.getParameter( gl.MAX_VERTEX_TEXTURE_IMAGE_UNITS ) === 0 ) {\r\n\t\t\tconsole.error( \"No support for vertex shader textures!\" );\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tgetPass: function ( name ) {\r\n\t\t/* todo: update to ECMA6 Array.find() */\r\n\t\tvar pass = null;\r\n\t\tthis.passes.some( function ( currPass ) {\r\n\r\n\t\t\tvar test = currPass.name === name;\r\n\t\t\tif ( test ) pass = currPass;\r\n\t\t\treturn test;\r\n\r\n\t\t} );\r\n\r\n\t\treturn pass;\r\n\r\n\t},\r\n\r\n\taddPass: function ( name, fragmentSahader, inputTargets ) {\r\n\r\n\t\tvar pass = new FBOPass( name, this.passThruVertexShader, fragmentSahader, this.bufferSize );\r\n\t\tpass.inputTargetList = inputTargets  || {};\r\n\t\tthis.passes.push( pass );\r\n\t\treturn pass;\r\n\r\n\t},\r\n\r\n\tupdatePassDependencies: function () {\r\n\r\n\t\tvar self = this;\r\n\t\tthis.passes.forEach( function ( currPass ) {\r\n\r\n\t\t\tObject.keys( currPass.inputTargetList ).forEach( function bindTarget( shaderInputName ) {\r\n\r\n\t\t\t\tvar targetPass = currPass.inputTargetList[ shaderInputName ];\r\n\t\t\t\tcurrPass.setInputTarget( shaderInputName, self.getPass( targetPass ).getRenderTarget() );\r\n\r\n\t\t\t} );\r\n\r\n\t\t} );\r\n\r\n\t},\r\n\r\n\t_renderPass: function ( shader, passTarget ) {\r\n\r\n\t\tthis.quad.material = shader;\r\n\t\tthis.renderer.render( this.scene, this.camera, passTarget, true );\r\n\r\n\t},\r\n\r\n\trenderInitialBuffer: function ( dataTexture, toPass ) {\r\n\r\n\t\tvar pass = this.getPass( toPass );\r\n\t\tthis.passThruShader.uniforms.passTexture.value = dataTexture;\r\n\t\tthis._renderPass( this.passThruShader, pass.doubleBuffer[ 1 ] ); // render to secondary buffer which is already set as input to first buffer.\r\n\t\tthis._renderPass( this.passThruShader, pass.doubleBuffer[ 0 ] ); // or just render to both\r\n\t\t/*!\r\n\t\t *\tdont call renderer.clear() before updating the simulation it will clear current active buffer which is the render target that we previously rendered to.\r\n\t\t *\tor just set active target to dummy target.\r\n\t\t */\r\n\t\tthis.renderer.setRenderTarget( this.dummyRenderTarget );\r\n\r\n\t},\r\n\r\n\tstep: function () {\r\n\r\n\t\tfor ( var i = 0; i < this.passes.length; i++ ) {\r\n\r\n\t\t\tthis.updatePassDependencies();\r\n\t\t\tvar currPass = this.passes[ i ];\r\n\t\t\tthis._renderPass( currPass.getShader(), currPass.getRenderTarget() );\r\n\t\t\tcurrPass.swapBuffer();\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n};\r\n\r\n\r\nfunction FBOPass( name, vertexShader, fragmentSahader, bufferSize ) {\r\n\r\n\tthis.name = name;\r\n\tthis.vertexShader = vertexShader;\r\n\tthis.fragmentSahader = fragmentSahader;\r\n\tthis.bufferSize = bufferSize;\r\n\r\n\tthis.currentBuffer = 0;\r\n\tthis.doubleBuffer = []; //  single FBO cannot act as input (texture) and output (render target) at the same time, we take the double-buffer approach\r\n\tthis.doubleBuffer[ 0 ] = this.generateRenderTarget();\r\n\tthis.doubleBuffer[ 1 ] = this.generateRenderTarget();\r\n\r\n\tthis.inputTargetList = {};\r\n\r\n\tthis.uniforms = {\r\n\t\tresolution: {\r\n\t\t\ttype: 'v2',\r\n\t\t\tvalue: new THREE.Vector2( this.bufferSize, this.bufferSize )\r\n\t\t},\r\n\t\tmirrorBuffer: {\r\n\t\t\ttype: 't',\r\n\t\t\tvalue: this.doubleBuffer[ 1 ]\r\n\t\t}\r\n\t};\r\n\r\n\tthis.shader = new THREE.ShaderMaterial( {\r\n\r\n\t\tuniforms: this.uniforms,\r\n\t\tvertexShader: this.vertexShader,\r\n\t\tfragmentShader: this.fragmentSahader\r\n\r\n\t} );\r\n\r\n}\r\n\r\nFBOPass.prototype = {\r\n\r\n\tgetShader: function () {\r\n\t\treturn this.shader;\r\n\t},\r\n\tgetRenderTarget: function () {\r\n\t\treturn this.doubleBuffer[ this.currentBuffer ];\r\n\t},\r\n\tsetInputTarget: function ( shaderInputName, inputTarget ) {\r\n\t\tthis.uniforms[ shaderInputName ] = {\r\n\t\t\ttype: 't',\r\n\t\t\tvalue: inputTarget\r\n\t\t};\r\n\t},\r\n\tswapBuffer: function () {\r\n\r\n\t\tthis.uniforms.mirrorBuffer.value = this.doubleBuffer[ this.currentBuffer ];\r\n\t\tthis.currentBuffer ^= 1; // toggle between 0 and 1\r\n\r\n\t},\r\n\tgenerateRenderTarget: function () {\r\n\r\n\t\tvar target = new THREE.WebGLRenderTarget( this.bufferSize, this.bufferSize, {\r\n\r\n\t\t\twrapS: THREE.ClampToEdgeWrapping,\r\n\t\t\twrapT: THREE.ClampToEdgeWrapping,\r\n\t\t\tminFilter: THREE.NearestFilter,\r\n\t\t\tmagFilter: THREE.NearestFilter,\r\n\t\t\tformat: THREE.RGBAFormat,\r\n\t\t\ttype: THREE.FloatType,\r\n\t\t\tstencilBuffer: false,\r\n\t\t\tdepthBuffer: false\r\n\r\n\t\t} );\r\n\r\n\t\treturn target;\r\n\r\n\t},\r\n\tattachUniform: function ( uniformsInput ) {\r\n\r\n\t\tvar self = this;\r\n\t\tObject.keys( uniformsInput ).forEach( function ( key ) {\r\n\r\n\t\t\tself.uniforms[ key ] = uniformsInput[ key ];\r\n\r\n\t\t} );\r\n\r\n\t}\r\n\r\n};\r\n","\r\nfunction HUD( renderer ) {\r\n\r\n\tthis.renderer = renderer;\r\n\tthis.HUDMargin = 0.05;\r\n\tvar hudHeight = 2.0 / 4.0; // 2.0 = full screen size\r\n\tvar hudWidth = hudHeight;\r\n\r\n\tthis.HUDCam = new THREE.OrthographicCamera( -SCREEN_RATIO, SCREEN_RATIO, 1, -1, 1, 10 );\r\n\tthis.HUDCam.position.z = 5;\r\n\r\n\tthis.hudMaterial = new THREE.ShaderMaterial( {\r\n\r\n\t\tuniforms: {\r\n\t\t\ttDiffuse: {\r\n\t\t\t\ttype: \"t\",\r\n\t\t\t\tvalue: this.tTarget\r\n\t\t\t}\r\n\t\t},\r\n\t\tvertexShader: SHADERS.hudVert,\r\n\t\tfragmentShader: SHADERS.hudFrag,\r\n\t\tdepthWrite: false,\r\n\t\tdepthTest: false,\r\n\t\tside: THREE.DoubleSide\r\n\r\n\t} );\r\n\r\n\r\n\tthis.hudGeo = new THREE.PlaneBufferGeometry( hudWidth, hudHeight );\r\n\tthis.hudGeo.applyMatrix( new THREE.Matrix4().makeScale( 1, -1, 1 ) ); // flipY\r\n\tthis.hudGeo.applyMatrix( new THREE.Matrix4().makeTranslation( hudWidth / 2, hudHeight / 2, 0 ) );\r\n\r\n\tthis.HUDMesh = new THREE.Mesh( this.hudGeo, this.hudMaterial );\r\n\tthis.HUDMesh.position.x = this.HUDCam.left + this.HUDMargin;\r\n\tthis.HUDMesh.position.y = this.HUDCam.bottom + this.HUDMargin;\r\n\r\n\tthis.HUDScene = new THREE.Scene();\r\n\tthis.HUDScene.add( this.HUDMesh );\r\n\r\n}\r\n\r\n\r\n\r\nHUD.prototype = {\r\n\r\n\tsetInputTexture: function ( target ) {\r\n\r\n\t\tthis.hudMaterial.uniforms.tDiffuse.value = target;\r\n\r\n\t},\r\n\r\n\trender: function () {\r\n\r\n\t\tthis.renderer.clearDepth();\r\n\t\tthis.renderer.render( this.HUDScene, this.HUDCam );\r\n\r\n\t},\r\n\r\n\tupdate: function () { // call on window resize\r\n\r\n\t\t// match aspect ratio to prevent distortion\r\n\t\tthis.HUDCam.left = -SCREEN_RATIO;\r\n\t\tthis.HUDCam.right = SCREEN_RATIO;\r\n\r\n\t\tthis.HUDMesh.position.x = this.HUDCam.left + this.HUDMargin;\r\n\t\tthis.HUDMesh.position.y = this.HUDCam.bottom + this.HUDMargin;\r\n\r\n\t\tthis.HUDCam.updateProjectionMatrix();\r\n\r\n\t}\r\n\r\n};\r\n","// warning: ugly code\r\nfunction createVoxelGrid() {\r\n\r\n   var gridSize = 512;\r\n   var gridResolution = 128;\r\n\r\n   var halfGridSize = gridSize * 0.5;\r\n   var cellSize = gridSize / gridResolution;\r\n   var cellCenter = cellSize * 0.5;\r\n   var voxelSize = cellSize * 0.85;\r\n\r\n   var gridGeom = new THREE.BufferGeometry();\r\n\r\n   var final = [];\r\n   var normals = [];\r\n   var topQuad = [];\r\n   var centroid = [];\r\n   var here = [];\r\n\r\n   function computeVoxelVertices() {\r\n\r\n      var s = voxelSize * 0.5;\r\n      var vertices = [];\r\n\r\n      vertices.push( [  s, -s,  s ] );\r\n      vertices.push( [ -s, -s,  s ] );\r\n      vertices.push( [ -s, -s, -s ] );\r\n      vertices.push( [  s, -s, -s ] );\r\n\r\n      vertices.push( [  s,  s,  s ] );\r\n      vertices.push( [ -s,  s,  s ] );\r\n      vertices.push( [ -s,  s, -s ] );\r\n      vertices.push( [  s,  s, -s ] );\r\n\r\n      return vertices;\r\n\r\n   }\r\n\r\n   function constructVoxel() {\r\n\r\n      var vv = computeVoxelVertices();\r\n\r\n      for ( var r = 0; r < gridResolution; r ++ ) {\r\n\r\n         for ( var c = 0; c < gridResolution; c ++ ) {\r\n\r\n            var rp = -halfGridSize + ( r + 1 ) * cellSize;\r\n            var cp = -halfGridSize + ( c + 1 ) * cellSize;\r\n\r\n            /*\r\n                6–––––––––––7\r\n               /|          /|\r\n              / |         / |    +y\r\n             5–––––––––––4  |     |\r\n             |  |        |  |     |\r\n             |  2––––––––|––3     +–––––––+x\r\n             | /         | /     /\r\n             |/          |/     /\r\n             1–––––––––––0    +z\r\n            */\r\n            [  // face order: CCW\r\n               6, 5, 4, 4, 7, 6, // +y\r\n               1, 2, 3, 3, 0, 1, // -y\r\n               5, 1, 0, 0, 4, 5, // +z\r\n               7, 3, 2, 2, 6, 7, // -z\r\n               4, 0, 3, 3, 7, 4, // +x\r\n               6, 2, 1, 1, 5, 6  // -x\r\n            ].forEach( qidx => {\r\n\r\n               final.push( vv[ qidx ][ 0 ] + rp );\r\n               final.push( vv[ qidx ][ 1 ] );\r\n               final.push( vv[ qidx ][ 2 ] + cp );\r\n\r\n               // flag topQuad to displace in shader\r\n               if ( qidx >= 4 && qidx <= 7 ) {\r\n                  topQuad.push( 1.0 );\r\n               } else {\r\n                  topQuad.push( -1.0 );\r\n               }\r\n\r\n               centroid.push( rp, cp );\r\n               here.push( ( r + 0.5 ) / gridResolution, ( c + 0.5 ) / gridResolution );\r\n\r\n            } );\r\n\r\n            [  // quad normals\r\n               [  0,  1,  0 ], // +y\r\n               [  0, -1,  0 ], // -y\r\n               [  0,  0,  1 ], // +z\r\n               [  0,  0, -1 ], // -z\r\n               [  1,  0,  0 ], // +x\r\n               [ -1,  0,  0 ]  // -x\r\n            ].forEach( quadNormal => {\r\n               for( var i = 0; i < 6; i ++ ) {\r\n                  quadNormal.forEach( p => normals.push( p ) );\r\n               }\r\n            } );\r\n\r\n         }\r\n\r\n      }\r\n\r\n   }\r\n\r\n   constructVoxel();\r\n\r\n   var buffVerts = new Float32Array( final );\r\n   var buffNorms = new Float32Array( normals );\r\n   var buffTopQuad = new Float32Array( topQuad );\r\n   var buffCentroid = new Float32Array( centroid );\r\n   var buffHere = new Float32Array( here );\r\n   console.log( 'buffVerts:', buffVerts.length );\r\n   console.log( 'buffNorms:', buffNorms.length );\r\n\r\n\tgridGeom.addAttribute( 'position', new THREE.BufferAttribute( buffVerts, 3 ) );\r\n\tgridGeom.addAttribute( 'normal'  , new THREE.BufferAttribute( buffNorms, 3 ) );\r\n\tgridGeom.addAttribute( 'topQuad'  , new THREE.BufferAttribute( buffTopQuad, 1 ) );\r\n   gridGeom.addAttribute( 'centroid'  , new THREE.BufferAttribute( buffCentroid, 2 ) );\r\n   gridGeom.addAttribute( 'here'  , new THREE.BufferAttribute( buffHere, 2 ) );\r\n\r\n\tvar gridShader = new THREE.ShaderMaterial( {\r\n\r\n\t\tuniforms: {\r\n\t\t\ttMatcap: { type: 't', value: TEXTURES.matcap },\r\n         tNoise:  { type: 't', value: null },\r\n\t\t},\r\n\t\tattributes: { // custom attribs go here\r\n\t\t\ttopQuad: { type: 'f', value: null },\r\n         centroid: { type: 'v2', value: null },\r\n         here: { type: 'v2', value: null }\r\n\t\t},\r\n\t\tvertexShader: SHADERS.gridVert,\r\n\t\tfragmentShader: SHADERS.gridFrag\r\n\r\n\t} );\r\n\r\n   var gridMesh = new THREE.Mesh( gridGeom, gridShader );\r\n\r\n\treturn gridMesh;\r\n\r\n}\r\n","'use strict';\r\n\r\nfunction main() {\r\n\r\n   initGui();\r\n\r\n   window.uniformsInput = {\r\n\t\ttime: { type: 'f', value: 0.0 }\r\n\t};\r\n\r\n   var fboSize = 512;\r\n\twindow.FBOC = new FBOCompositor( RENDERER, fboSize, SHADERS.passVert );\r\n\tFBOC.addPass( 'noisePass', SHADERS.noiseFrag, null );\r\n   FBOC.getPass( 'noisePass' ).attachUniform( uniformsInput );\r\n\r\n   window.grid = createVoxelGrid();\r\n   SCENE.add( grid );\r\n\r\n   CAMERA.position.set( -354.9, 241.9, 374.6 );\r\n   CAMERA.rotation.set( -0.573, -0.672, -0.382 );\r\n\r\n   // window.grid2 = createVoxelGrid();\r\n   // grid2.rotateZ( Math.PI * 0.5 );\r\n   // grid2.position.set( 256, 256, 0 );\r\n   // SCENE.add( grid2 );\r\n   //\r\n   // window.grid3 = createVoxelGrid();\r\n   // grid3.rotateX( Math.PI * 0.5 );\r\n   // grid3.position.set( 0, 256, -256 );\r\n   // SCENE.add( grid3 );\r\n\r\n   window.hud = new HUD( RENDERER );\r\n\r\n}\r\n","'use strict';\r\n\r\nfunction update() {\r\n\r\n\tuniformsInput.time.value = CLOCK.getElapsedTime();\r\n\r\n\tFBOC.step();\r\n\tgrid.material.uniforms.tNoise.value = FBOC.getPass( 'noisePass' ).getRenderTarget();\r\n\r\n\tupdateGuiDisplay();\r\n\r\n}\r\n\r\n\r\n// ----  draw loop\r\nfunction run() {\r\n\r\n\trequestAnimationFrame( run );\r\n\tRENDERER.clear();\r\n\tupdate();\r\n\tRENDERER.render( SCENE, CAMERA );\r\n\r\n\thud.setInputTexture( FBOC.getPass( 'noisePass' ).getRenderTarget() );\r\n\thud.render();\r\n\r\n\tSTATS.update();\r\n\r\n};\r\n","'use strict';\r\n\r\nwindow.addEventListener( 'keypress', event => {\r\n\r\n\tswitch( event.keyCode ) {\r\n\r\n\t\tcase 65:/*A*/\r\n\t\tcase 97:/*a*/ SCENE_SETTINGS.enableGridHelper ^= 1; updateHelpers();\r\n\t\tbreak;\r\n\r\n\t\tcase 83 :/*S*/\r\n\t\tcase 115:/*s*/ SCENE_SETTINGS.enableAxisHelper ^= 1; updateHelpers();\r\n\t\tbreak;\r\n\r\n\t}\r\n\r\n} );\r\n\r\nwindow.addEventListener( 'resize', debounce( onWindowResize, 50 ) );\r\n\r\nfunction onWindowResize() {\r\n\r\n\tWIDTH = window.innerWidth;\r\n\tHEIGHT = window.innerHeight;\r\n\r\n\tPIXEL_RATIO = window.devicePixelRatio || 1;\r\n\tSCREEN_RATIO = WIDTH/HEIGHT;\r\n\r\n\tCAMERA.aspect = SCREEN_RATIO;\r\n\tCAMERA.updateProjectionMatrix();\r\n\r\n\tRENDERER.setSize( WIDTH, HEIGHT );\r\n\tRENDERER.setPixelRatio( PIXEL_RATIO );\r\n\r\n\thud.update();\r\n\r\n}\r\n","'use strict';\r\n\r\nfunction debounce(func, wait, immediate) {\r\n\r\n\tvar timeout;\r\n\treturn () => {\r\n\r\n\t\tvar context = this, args = arguments;\r\n\t\tvar later = () => {\r\n\r\n\t\t\ttimeout = null;\r\n\t\t\tif (!immediate) func.apply(context, args);\r\n\r\n\t\t};\r\n\t\tvar callNow = immediate && !timeout;\r\n\t\tclearTimeout(timeout);\r\n\t\ttimeout = setTimeout(later, wait);\r\n\t\tif (callNow) func.apply(context, args);\r\n\r\n\t};\r\n\r\n}\r\n"],"sourceRoot":"/source/"}